import{c as t,o as s,a as i,f as e,b as h}from"./p-Ivb1APnD.js";import{l as o}from"./p-BTbln26t.js";class r{constructor(r,n="hover",l,f,c=0,a=0,p,m,u,g=200,d=300,b){this.computePosition=()=>{if(!this.triggerRef||!this.contentRef){console.warn("Popover: triggerRef or contentRef is not found");return}if(!this.open)return;const o=[];let r=this.offset;if(this.arrowRef){const t=this.arrowRef.offsetWidth;r+=Math.sqrt(2*t**2)/2}o.push(s({alignmentAxis:-this.contentPadding,crossAxis:-this.contentPadding,mainAxis:r+this.contentPadding}));const n=this.placements?this.placements.split(","):[];const l=n[0];if(n.length===0){o.push(i())}else{const t=n.splice(1);o.push(e({fallbackPlacements:t}))}if(this.arrowRef)o.push(h({element:this.arrowRef}));t(this.triggerRef,this.contentRef,{middleware:o,placement:l}).then((({middlewareData:t,placement:s,strategy:i,x:e,y:h})=>{const[o,r]=s.split("-");const n={};n.left=`${e}px`;n.top=`${h}px`;n.position=i==="fixed"?"fixed":"absolute";let l=0;let f=0;if(o==="top"||o==="bottom"){if(o==="top"){l=-2}else if(o==="bottom"){l=2}if(r==="start"){f=2}else if(r==="end"){f=-2}}else if(o==="left"||o==="right"){if(o==="left"){f=-2}else if(o==="right"){f=2}if(r==="start"){l=-2}else if(r==="end"){l=2}}this.contentRef.style.setProperty("--popover-content-shadow",`drop-shadow(${f}px ${l}px 2px rgba(0, 0, 0, 0.2))`);Object.assign(this.contentRef.style,n);if(t.arrow){const{x:s,y:i}=t.arrow;const e={bottom:"top",left:"right",right:"left",top:"bottom"}[o];Object.assign(this.arrowRef.style,{bottom:"",left:s===null?"":`${s}px`,right:"",[e]:`${-this.arrowRef.offsetWidth/2}px`,top:i===null?"":`${i}px`})}}))};this.computePositionThrottle=o.throttle(this.computePosition,80,{leading:true,trailing:true});this.hidePopover=()=>{if(this.open){this.open=false;this.hideCallback()}};this.mouseleaveHandler=t=>{var s;const i=(s=t.path)!==null&&s!==void 0?s:t.composedPath();const e=i.find((t=>t===this.host));if(e){const t=()=>{const t=document.querySelectorAll(":hover");const s=Array.prototype.indexOf.call(t,e);if(s<0){this.hidePopover()}};setTimeout(t,this.dismissTimeout)}else{this.hidePopover()}};this.showPopover=()=>{if(!this.open){if(this.trigger==="hover"){setTimeout((()=>{if(this.triggerRef.matches(":hover")){this.showCallback()}}),this.openTimeout)}else{this.showCallback()}}};this.windowClickHandler=t=>{if((this.trigger==="click"||this.trigger==="hover")&&this.open){const s=t.path||t.composedPath();for(const t of s){if(t===this.host||this.triggers.includes(t))return}this.hidePopover()}};this.host=r;this.open=l;this.trigger=n;this.contentRef=f;this.offset=c;this.arrowRef=b;this.placements=u;this.openTimeout=g;this.dismissTimeout=d;this.triggers=[];this.showCallback=p;this.hideCallback=m;this.contentPadding=a;this.observer=new IntersectionObserver((()=>this.intersectingCallback()),{threshold:[0,1]});this.observer.observe(this.contentRef)}destroy(){this.observer.disconnect();this.observer=null}intersectingCallback(){this.open&&this.computePositionThrottle("onTriggerIntersection")}registerTarget(t){if(!t)throw new Error("The trigger element for the popover is not found.");if(this.triggers.includes(t))return;this.observer.observe(t);if(this.trigger==="hover"){t.addEventListener("focus",(()=>{this.triggerRef=t;this.showPopover()}));t.addEventListener("blur",(()=>this.hidePopover()));t.addEventListener("mouseenter",(()=>{this.triggerRef=t;this.showPopover()}));t.addEventListener("mouseleave",this.mouseleaveHandler)}else if(this.trigger==="click"){if(t.nodeName==="ZANE-BUTTON"){t.addEventListener("zane-button--click",(()=>{this.open?this.hidePopover():this.showPopover()}))}else{t.addEventListener("click",(()=>{this.open?this.hidePopover():this.showPopover()}))}}this.triggers.push(t)}setOpen(t){this.open=t}setTriggerRef(t){this.triggerRef=t}}export{r as P};
//# sourceMappingURL=p-5mOPzLJY.js.map