{"version":3,"file":"zane-code-highlighter.entry.esm.js","sources":["src/3d-party/prism/index.tsx","src/components/code-highlighter/code-highlighter.scss?tag=zane-code-highlighter&encapsulation=shadow","src/components/code-highlighter/code-highlighter.tsx"],"sourcesContent":["import { getAssetPath } from '@stencil/core';\n\nimport { loadScript, waitUntil } from '../../utils';\n\nconst VERSION = '1.30.0';\n\nconst win = window as any;\n\nlet loadPrismCalled = false;\n\nexport async function loadPrism() {\n  if (loadPrismCalled) {\n    await waitUntil(() => !!win.Prism);\n    return;\n  }\n\n  loadPrismCalled = true;\n\n  // eslint-disable-next-line n/prefer-global/process\n  if (process.env.THIRD_PARTY_ASSETS === 'LOCAL') {\n    await loadScript(\n      getAssetPath(\n        './assets/node_modules/prismjs/components/prism-core.min.js',\n      ),\n    );\n    await loadScript(\n      getAssetPath(\n        './assets/node_modules/prismjs/plugins/autoloader/prism-autoloader.min.js',\n      ),\n    );\n  } else {\n    await loadScript(\n      `https://cdn.jsdelivr.net/npm/prismjs@${VERSION}/components/prism-core.min.js`,\n    );\n    await loadScript(\n      `https://cdn.jsdelivr.net/npm/prismjs@${VERSION}/plugins/autoloader/prism-autoloader.min.js`,\n    );\n  }\n\n  await waitUntil(() => !!win.Prism);\n}\n\nconst loadPrismLanguageCalled: any = {};\n\nexport async function loadPrismLanguage(language: string) {\n  const Prism = win.Prism;\n\n  if (loadPrismLanguageCalled[language]) {\n    await waitUntil(() => !!Prism.languages[language]);\n    return;\n  }\n\n  loadPrismLanguageCalled[language] = true;\n\n  await autoLoader(language);\n}\n\nexport async function autoLoader(language: string) {\n  const Prism = win.Prism;\n  const autoloader = Prism.plugins.autoloader;\n  return await new Promise((resolve) => {\n    autoloader.loadLanguages([language], () => {\n      resolve(1);\n    });\n  });\n}\n","@use '../../3d-party/prism/prism';\n@use '../../3d-party/prism/prism-line-numbers';\n@use '../../global/styles/commons';\n\n:host {\n  /**\n    * @prop --zane-code-highlighter-background: Code Highlighter background color\n    */\n  --zane-code-highlighter-background: var(--code-bg-primary);\n\n  display: block;\n  height: 100%;\n}\n\n.code-loader {\n  display: flex;\n  gap: var(--spacing-02);\n  align-items: center;\n  justify-content: center;\n  height: 10rem;\n  background-color: var(--zane-code-highlighter-background);\n}\n\n.code-highlighter {\n  position: relative;\n  height: 100%;\n  color: var(--text-primary);\n  background-color: var(--zane-code-highlighter-background);\n\n  .scroll-wrapper {\n    height: 100%;\n    overflow: auto;\n\n    .line-numbers-wrapper {\n      position: relative;\n      padding: var(--spacing-05);\n      padding-inline-end: 3rem;\n\n      @include commons.font-style(code-02);\n\n      &.line-numbers {\n        margin-left: 3.8rem;\n      }\n\n      .highlighter {\n        position: relative;\n        margin: 0;\n      }\n    }\n  }\n\n  .copy-btn {\n    position: absolute;\n    top: 0.675rem;\n    right: var(--spacing-03);\n    background-color: var(--zane-code-highlighter-background);\n  }\n}\n\n:host([inline]) {\n  display: inline;\n  height: initial;\n\n  .code-highlighter {\n    display: inline;\n    cursor: pointer;\n\n    .scroll-wrapper {\n      display: inline;\n\n      .line-numbers-wrapper {\n        display: inline;\n        padding: 0 var(--spacing-03);\n        font-size: inherit;\n        word-wrap: break-word;\n\n        .highlighter {\n          display: inline;\n        }\n      }\n    }\n  }\n\n  .code-loader {\n    display: inline;\n    height: initial;\n  }\n}\n","import {\n  Component,\n  ComponentInterface,\n  Element,\n  Fragment,\n  h,\n  Host,\n  Prop,\n  State,\n  Watch,\n} from '@stencil/core';\nimport * as beautify from 'js-beautify/js';\n\nimport { loadPrism, loadPrismLanguage } from '../../3d-party/prism';\nimport { Language } from '../../constants';\nimport { getComponentIndex, isInViewport } from '../../utils';\n\n// 将window声明为any类型以访问Prism等全局变量\nconst win = window as any;\n\n/**\n * 本地化字符串配置对象\n */\nconst locale: {\n  copied: string;\n  copiedCode: string;\n  copyToClipboard: string;\n  loading: string;\n} = {\n  copied: 'Copied',\n  copiedCode: 'Copied code',\n  copyToClipboard: 'Copy to clipboard',\n  loading: 'Loading code...',\n};\n\n/**\n * 代码高亮组件\n * @Component 装饰器定义组件元数据\n * @shadow 启用Shadow DOM封装\n * @styleUrl 组件样式表路径\n * @tag 组件自定义标签名称\n */\n@Component({\n  shadow: true,\n  styleUrl: 'code-highlighter.scss',\n  tag: 'zane-code-highlighter',\n})\nexport class CodeHighlighter implements ComponentInterface {\n  /**\n   * 编译后的高亮代码HTML字符串\n   * @State 装饰器表示这是组件内部状态，变化会触发重新渲染\n   */\n  @State() compiledCode: string = null;\n\n  /**\n   * 复制按钮的状态\n   * - `copied`: 表示代码已被复制\n   * - `idle`: 表示默认状态，可进行复制操作\n   * @State 装饰器表示这是组件内部状态\n   */\n  @State() copyState: 'copied' | 'idle' = 'idle';\n\n  /**\n   * 是否格式化代码\n   * @Prop 装饰器表示这是组件的公开属性\n   * @mutable 表示属性可变\n   * @reflect 表示属性值会反映到DOM属性上\n   */\n  @Prop({ mutable: true, reflect: true }) format: boolean;\n\n  /**\n   * 组件唯一ID\n   */\n  gid: string = getComponentIndex();\n\n  /**\n   * 是否隐藏复制按钮\n   * @Prop 默认值为false\n   */\n  @Prop() hideCopy: boolean = false;\n\n  /**\n   * 宿主元素引用\n   * @Element 装饰器获取宿主元素\n   */\n  @Element() host!: HTMLElement;\n\n  /**\n   * 是否为内联模式（非块级显示）\n   * @Prop 装饰器，reflect表示会反映到DOM属性上\n   */\n  @Prop({ reflect: true }) inline: boolean = false;\n\n  /**\n   * 代码语言类型\n   * @Prop 装饰器，reflect表示会反映到DOM属性上\n   * 默认值为'javascript'\n   */\n  @Prop({ reflect: true }) language: Language = 'javascript';\n\n  /**\n   * 是否显示行号\n   * @Prop 装饰器，reflect表示会反映到DOM属性上\n   */\n  @Prop({ reflect: true }) lineNumbers: boolean = false;\n\n  /**\n   * 代码内容\n   * @Prop 装饰器\n   */\n  @Prop() value: string = '';\n\n  /**\n   * 原始代码字符串\n   */\n  private codeString: string = '';\n\n  /**\n   * 处理后的代码字符串（格式化后）\n   */\n  private parsedCodeString: string = '';\n\n  /**\n   * 组件加载完成生命周期钩子\n   * 初始化Prism高亮库\n   */\n  componentDidLoad() {\n    this.initializePrism();\n  }\n\n  /**\n   * 组件即将加载生命周期钩子\n   * 初始化代码字符串\n   */\n  async componentWillLoad() {\n    this.codeString = '';\n    // 优先级：value属性 > code标签内容 > 宿主元素文本内容\n    if (this.value) {\n      this.codeString = this.value;\n    } else if (this.host.querySelector('code')) {\n      this.codeString = this.host.querySelector('code').innerHTML;\n    } else if (this.host.hasChildNodes()) {\n      this.codeString = this.host.innerText;\n    }\n\n    // 如果未设置format属性，则根据inline模式自动决定\n    if (this.format === undefined) {\n      this.format = !this.inline;\n    }\n\n    this.codeString = this.decode(this.codeString);\n  }\n\n  /**\n   * HTML实体解码\n   * @param str 需要解码的字符串\n   * @returns 解码后的字符串\n   */\n  decode(str: string) {\n    return str.replaceAll('&lt;', '<').replaceAll('&gt;', '>');\n  }\n\n  /**\n   * 初始化Prism高亮库\n   * 如果Prism未加载则先加载\n   * 如果元素不在可视区域则延迟初始化\n   */\n  async initializePrism() {\n    if (!win.Prism) {\n      await loadPrism();\n    }\n\n    // 如果元素不在可视区域内，延迟初始化\n    if (!isInViewport(this.host)) {\n      setTimeout(() => this.initializePrism(), 300);\n      return;\n    }\n\n    const Prism = win.Prism;\n    const autoloader = Prism.plugins.autoloader;\n    if (autoloader) {\n      // 如果需要自动加载语言，则先加载指定语言\n      await loadPrismLanguage(this.language);\n      this.#renderPrism();\n    } else {\n      this.#renderPrism();\n    }\n  }\n\n  /**\n   * 监听language属性变化\n   * 当语言变化时重新渲染高亮代码\n   */\n  @Watch('language')\n  languageWatcher() {\n    this.#renderPrism();\n  }\n\n  /**\n   * 渲染组件\n   * @returns 组件虚拟 DOM\n   */\n  render() {\n    return (\n      <Host>\n        {this.compiledCode !== null && (\n          <div\n            class=\"code-highlighter\"\n            on-click={async () => {\n              if (this.inline) await this.#handleCopyClick();\n            }}\n          >\n            <div class=\"scroll-wrapper\">\n              <div\n                class={{\n                  'line-numbers': this.lineNumbers,\n                  'line-numbers-wrapper': true,\n                }}\n              >\n                {this.#renderHighlighter()}\n              </div>\n            </div>\n            {!this.hideCopy && this.copyState === 'idle' && !this.inline && (\n              <Fragment>\n                <zane-tooltip\n                  class={'copy-btn'}\n                  content={locale.copyToClipboard}\n                >\n                  <zane-button\n                    aria-label=\"Copy to clipboard\"\n                    class=\"icon-only\"\n                    color={'secondary'}\n                    icon={'copy'}\n                    onZane-button--click={async () => {\n                      await this.#handleCopyClick();\n                    }}\n                    size=\"sm\"\n                    variant={'ghost'}\n                  ></zane-button>\n                </zane-tooltip>\n              </Fragment>\n            )}\n            {!this.hideCopy && this.copyState === 'copied' && !this.inline && (\n              <div>\n                <zane-button\n                  aria-label={locale.copiedCode}\n                  class=\"copy-btn icon-only test\"\n                  color={'success'}\n                  icon={'checkmark'}\n                  size=\"sm\"\n                  title={locale.copiedCode}\n                  variant={'default'}\n                >\n                  {locale.copied}\n                </zane-button>\n              </div>\n            )}\n          </div>\n        )}\n        {this.compiledCode === null && (\n          <div class=\"code-loader\">\n            <zane-spinner>{locale.loading}</zane-spinner>\n          </div>\n        )}\n      </Host>\n    );\n  }\n\n  /**\n   * 监听 `lineNumbers` 属性变化\n   * 当行号显示设置变化时重新渲染高亮代码\n   */\n  @Watch('lineNumbers')\n  themeWatcher() {\n    this.#renderPrism();\n  }\n\n  /**\n   * 监听 `value` 属性变化\n   * 当代码内容变化时重新渲染高亮代码\n   */\n  @Watch('value')\n  valueWatcher() {\n    if (this.value) {\n      this.codeString = this.value;\n    }\n    this.#renderPrism();\n  }\n\n  /**\n   * 处理复制按钮点击事件\n   * 使用textarea元素和execCommand API实现复制到剪贴板\n   */\n  async #handleCopyClick() {\n    const textToCopy = this.parsedCodeString;\n    const textArea = document.createElement('textarea');\n    textArea.value = textToCopy;\n\n    textArea.style.position = 'absolute';\n    textArea.style.left = '-999999px';\n\n    document.body.prepend(textArea);\n    textArea.select();\n\n    try {\n      document.execCommand('copy');\n    } catch (error) {\n      console.error(error);\n    } finally {\n      textArea.remove();\n    }\n\n    this.copyState = 'copied';\n\n    // 更新复制状态，3秒后恢复\n    setTimeout(() => {\n      this.copyState = 'idle';\n    }, 3000);\n  }\n\n  /**\n   * 使用Prism高亮代码\n   * 根据lineNumbers属性决定是否添加行号\n   */\n  #populateCode() {\n    const Prism = win.Prism;\n    const formatted = Prism.highlight(\n      this.parsedCodeString,\n      Prism.languages[this.language],\n      this.language,\n    );\n    let lineNumbersWrapper = '';\n    if (this.lineNumbers) {\n      const linesNum = formatted.split('\\n').length;\n      const lines = Array.from({ length: linesNum + 1 }).join('<span></span>');\n      lineNumbersWrapper = `<span aria-hidden='true' class='line-numbers-rows'>${lines}</span>`;\n    }\n    this.compiledCode = formatted + lineNumbersWrapper;\n  }\n\n  /**\n   * 渲染高亮代码容器\n   * 根据inline属性决定使用div还是pre元素\n   * @returns 高亮代码容器的虚拟DOM\n   */\n  #renderHighlighter() {\n    return this.inline ? (\n      <div class=\"highlighter\" innerHTML={this.compiledCode} />\n    ) : (\n      <pre class=\"highlighter line-numbers\" innerHTML={this.compiledCode} />\n    );\n  }\n\n  /**\n   * 渲染Prism高亮代码\n   * 根据language属性决定是否格式化代码\n   * 支持的语言: javascript, html, css\n   */\n  #renderPrism() {\n    if (\n      (this.format && this.language === 'javascript') ||\n      this.language === 'html' ||\n      this.language === 'css'\n    ) {\n      switch (this.language) {\n        case 'css': {\n          this.parsedCodeString = beautify.css(this.codeString, {\n            wrap_line_length: 120,\n          });\n          break;\n        }\n        case 'html': {\n          this.parsedCodeString = beautify.html(this.codeString, {\n            wrap_line_length: 120,\n          });\n          break;\n        }\n        case 'javascript': {\n          this.parsedCodeString = beautify.js(this.codeString, {\n            wrap_line_length: 120,\n          });\n          break;\n        }\n      }\n      this.#populateCode();\n    } else {\n      // 其他语言不格式化，直接高亮\n      this.parsedCodeString = this.codeString;\n      this.#populateCode();\n    }\n  }\n}\n"],"names":["win","beautify.css","beautify.html","beautify.js"],"mappings":"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"}