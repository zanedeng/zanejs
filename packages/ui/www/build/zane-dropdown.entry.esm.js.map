{"version":3,"file":"zane-dropdown.entry.esm.js","sources":["src/components/dropdown/dropdown/dropdown.scss?tag=zane-dropdown&encapsulation=shadow","src/components/dropdown/dropdown/dropdown.tsx"],"sourcesContent":["@use '../../../global/styles/commons';\n\n:host {\n  --dropdown-height: inherit;\n\n  display: inline-block;\n  height: var(--dropdown-height);\n}\n\n.dropdown {\n  display: inline-block;\n  height: var(--dropdown-height);\n\n  zane-menu {\n    --zane-menu-shadow: none;\n  }\n}\n","import {\n  Component,\n  ComponentInterface,\n  Element,\n  Event,\n  EventEmitter,\n  h,\n  Host,\n  Listen,\n  Method,\n  Prop,\n} from '@stencil/core';\n\nimport PopoverController from '../../popover/popover/popover-controller';\n\n/**\n * @name Dropdown\n * @description Enables native inputs to be used within a Form field.\n * @category Navigation\n * @subcategory Dropdown\n * @img /assets/img/dropdown.webp\n * @imgDark /assets/img/dropdown-dark.webp\n */\n@Component({\n  shadow: true,\n  styleUrl: 'dropdown.scss',\n  tag: 'zane-dropdown',\n})\nexport class Dropdown implements ComponentInterface {\n  /**\n   * Emitted when the dropdown is closed.\n   */\n  @Event({ eventName: 'zane-dropdown--close' }) closeEvent: EventEmitter;\n\n  /**\n   * If true, the user cannot interact with the button. Defaults to `false`.\n   */\n  @Prop() disabled: boolean = false;\n  @Element() host!: HTMLElement;\n  @Prop({ reflect: true }) managed: boolean = false;\n  menuRef: HTMLZaneDropdownMenuElement;\n\n  @Prop({ mutable: true, reflect: true }) open: boolean = false;\n\n  /**\n   * Emitted when the dropdown is opened.\n   */\n  @Event({ eventName: 'zane-dropdown--open' }) openEvent: EventEmitter;\n\n  @Prop({ reflect: true }) placements: string =\n    'bottom-start,top-start,bottom-end,top-end';\n\n  popoverController: PopoverController;\n\n  slotRef: HTMLSlotElement;\n\n  @Prop({ reflect: true }) trigger: 'click' | 'hover' | 'manual' = 'click';\n\n  triggerRef: HTMLElement | HTMLZaneButtonElement;\n\n  @Event({ eventName: 'zane-dropdown--item-click' })\n  zaneDropdownItemClick: EventEmitter;\n\n  componentDidLoad() {\n    const contentRef = this.host.querySelector('zane-dropdown-menu');\n\n    if (!contentRef) {\n      throw new Error(\n        'zane-dropdown: The dropdown component must have a zane-dropdown-menu child component',\n      );\n    }\n\n    this.menuRef = contentRef;\n\n    this.popoverController = new PopoverController(\n      this.host,\n      this.trigger,\n      this.open,\n      contentRef,\n      0,\n      0,\n      this.showPopover,\n      this.hidePopover,\n      this.placements,\n    );\n\n    this.triggerRef = this.slotRef.assignedElements()[0] as HTMLElement;\n    if (this.triggerRef.nodeName === 'SLOT') {\n      const assignedElements = (\n        this.triggerRef as HTMLSlotElement\n      ).assignedElements();\n      if (assignedElements.length > 0) {\n        this.triggerRef = assignedElements[0] as HTMLSlotElement;\n      }\n    }\n\n    this.popoverController.registerTarget(this.triggerRef);\n    this.popoverController.setTriggerRef(this.triggerRef);\n\n    this.host.addEventListener('zane-menu-item--click', (evt: CustomEvent) => {\n      this.zaneDropdownItemClick.emit(evt.detail);\n      this.setFocusOnTrigger();\n      this.popoverController.hidePopover();\n    });\n\n    this.host.addEventListener('keydown', (evt) => {\n      if (evt.key === 'Escape') {\n        evt.preventDefault();\n        this.popoverController.hidePopover();\n      }\n    });\n  }\n\n  componentDidUpdate() {\n    this.popoverController.setOpen(this.open);\n    if (this.open) {\n      this.popoverController.computePositionThrottle('onUpdate');\n    }\n  }\n\n  disconnectedCallback() {\n    this.popoverController.destroy();\n  }\n\n  hidePopover = () => {\n    this.open = false;\n    this.closeEvent.emit();\n  };\n\n  render() {\n    return (\n      <Host>\n        <div\n          class={{\n            dropdown: true,\n            open: this.open,\n          }}\n        >\n          <slot ref={(el) => (this.slotRef = el as HTMLSlotElement)} />\n        </div>\n      </Host>\n    );\n  }\n\n  @Listen('resize', { target: 'window' })\n  resizeHandler() {\n    this.popoverController.computePositionThrottle('resize');\n  }\n\n  @Method()\n  async setFocus() {\n    this.setFocusOnTrigger();\n  }\n\n  setFocusOnTrigger() {\n    (this.triggerRef as HTMLZaneButtonElement).setFocus\n      ? (this.triggerRef as HTMLZaneButtonElement).setFocus()\n      : this.triggerRef.focus();\n  }\n\n  showPopover = () => {\n    this.open = true;\n    setTimeout(() => {\n      this.menuRef.setFocus();\n      this.openEvent.emit();\n    });\n  };\n\n  @Listen('click', { target: 'window' })\n  windowClickHandler(evt) {\n    this.popoverController.windowClickHandler(evt);\n  }\n}\n"],"names":[],"mappings":"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"}