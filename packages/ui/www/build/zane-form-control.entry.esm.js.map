{"version":3,"file":"zane-form-control.entry.esm.js","sources":["src/components/form-control/form-control.scss?tag=zane-form-control&encapsulation=shadow","src/components/form-control/form-control.tsx"],"sourcesContent":["@use '../../global/styles/common-input';\n\n:host(.form-field) {\n  margin-bottom: common-input.v(--spacing-07);\n}\n","import {\n  Component,\n  ComponentInterface,\n  Element,\n  h,\n  Host,\n  Prop,\n} from '@stencil/core';\n\n/**\n * 表单控件容器组件\n * @Component 装饰器定义组件元数据\n * @shadow 启用Shadow DOM封装\n * @styleUrl 组件样式表路径\n * @tag 组件自定义标签名称\n */\n@Component({\n  shadow: true,\n  styleUrl: 'form-control.scss',\n  tag: 'zane-form-control',\n})\nexport class FormControl implements ComponentInterface {\n  /**\n   * 宿主元素引用\n   * @Element 装饰器获取宿主元素\n   */\n  @Element() elm!: HTMLElement;\n\n  /**\n   * 辅助文本\n   * 显示在表单控件下方的帮助信息\n   * @Prop\n   */\n  @Prop() helperText: string;\n\n  /**\n   * 是否为内联布局\n   * @Prop 装饰器，reflect表示会反映到DOM属性上\n   * 默认值为false\n   */\n  @Prop({ reflect: true }) inline: boolean = false;\n\n  /**\n   * 是否为无效状态\n   * @Prop\n   */\n  @Prop() invalid: boolean = false;\n\n  /**\n   * 无效状态提示文本\n   * @Prop\n   */\n  @Prop() invalidText: string;\n\n  /**\n   * 标签文本\n   * @Prop\n   */\n  @Prop() label: string;\n\n  /**\n   * 是否为必填项\n   * @Prop\n   */\n  @Prop() required: boolean = false;\n\n  /**\n   * 是否显示骨架屏\n   * 用于加载状态\n   * @Prop\n   */\n  @Prop() skeleton: boolean = false;\n\n  /**\n   * 是否为警告状态\n   * @Prop\n   */\n  @Prop() warn: boolean = false;\n\n  /**\n   * 警告状态提示文本\n   * @Prop\n   */\n  @Prop() warnText: string;\n\n  /**\n   * 组件加载完成生命周期钩子\n   * 设置ARIA角色并传递属性到内部表单控件\n   */\n  componentDidLoad() {\n    this.elm.setAttribute('role', 'group');\n    const controlElm = this.getInputElement();\n    this.passRequiredToField(controlElm, this.required);\n    this.passLabelToField(controlElm, this.label);\n  }\n\n  /**\n   * 组件是否应该更新的生命周期钩子\n   * 用于在特定属性变化时更新内部表单控件\n   */\n  componentShouldUpdate(newVal: any, _oldVal, propName: string) {\n    if (propName === 'required') {\n      this.passRequiredToField(this.getInputElement(), newVal);\n    } else if (propName === 'label') {\n      this.passLabelToField(this.getInputElement(), newVal);\n    }\n  }\n\n  /**\n   * 获取内部表单控件元素\n   * 支持多种表单控件类型\n   * @returns 找到的表单控件元素或undefined\n   */\n  getInputElement() {\n    for (const compName of [\n      'zane-input',\n      'zane-textarea',\n      'zane-select',\n      'zane-checkbox',\n      'zane-radio',\n      'zane-code-editor',\n    ]) {\n      const controlElm = this.elm.querySelector(`${compName}`);\n      if (controlElm) return controlElm;\n    }\n  }\n\n  /**\n   * 渲染标签\n   * 根据skeleton状态决定渲染真实标签还是骨架屏\n   * @returns 标签的虚拟DOM\n   */\n  getLabel() {\n    return this.skeleton ? (\n      <div class=\"label skeleton\" />\n    ) : (\n      <label class=\"label\">\n        {this.required && <span class=\"required\">*</span>}\n        {this.label}\n      </label>\n    );\n  }\n\n  /**\n   * 传递label属性到内部表单控件\n   * @param controlElm 表单控件元素\n   * @param label 标签文本\n   */\n  passLabelToField(controlElm: Element, label: string) {\n    if (controlElm) {\n      const el = controlElm as any;\n      const oldProps = el.configAria;\n      el.configAria = {\n        'aria-label': label,\n        ...oldProps,\n      };\n    }\n  }\n\n  /**\n   * 传递required属性到内部表单控件\n   * @param controlElm 表单控件元素\n   * @param required 是否必填\n   */\n  passRequiredToField(controlElm: Element, required: boolean) {\n    if (controlElm) {\n      const el = controlElm as any;\n      el.required = required;\n    }\n  }\n\n  /**\n   * 渲染组件\n   * @returns 组件虚拟DOM\n   */\n  render() {\n    return (\n      <Host invalid={this.invalid} warn={this.warn}>\n        <div class={{ 'form-control': true, inline: this.inline }}>\n          {this.label && this.getLabel()}\n          <div class=\"field\">\n            <slot />\n          </div>\n          {this.renderHelper()}\n        </div>\n      </Host>\n    );\n  }\n\n  /**\n   * 渲染辅助信息\n   * 根据状态显示不同的辅助文本\n   * @returns 辅助信息的虚拟DOM\n   */\n  renderHelper() {\n    if (this.invalid)\n      return <div class=\"helper invalid\">{this.invalidText}</div>;\n    else if (this.warn) return <div class=\"helper warn\">{this.warnText}</div>;\n    else if (this.helperText || this.helperText === '')\n      return <div class=\"helper text\">{this.helperText}</div>;\n  }\n}\n"],"names":[],"mappings":"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"}