{"version":3,"names":["datePickerCss","DatePicker","constructor","hostRef","this","configAria","debounce","disabled","gid","getComponentIndex","hasFocus","inline","invalid","name","readonly","required","size","value","warn","blurHandler","ev","zaneBlur","emit","clearInput","evt","nativeElement","inputHandler","focusHandler","zaneFocus","input","target","oldValue","zaneInput","zaneChange","keyDownHandler","key","componentWillLoad","elm","hasAttribute","tabindex","getAttribute","undefined","removeAttribute","getAttributeNames","forEach","includes","connectedCallback","debounceChanged","getComponentId","render","h","Host","hasValue","class","label","onBlur","onFocus","onInput","onKeyDown","ref","type","color","icon","setTimeout","showPicker","variant","renderHelper","invalidText","warnText","helperText","setBlur","blur","setFocus","focus","debounceEvent","getValue","toString","length"],"sources":["src/components/date-picker/date-picker.scss?tag=zane-date-picker&encapsulation=shadow","src/components/date-picker/date-picker.tsx"],"sourcesContent":["@use '../../global/styles/common-input';\n\ninput[type='date']::-webkit-inner-spin-button,\ninput[type='date']::-webkit-calendar-picker-indicator {\n  display: none;\n  appearance: none;\n}\n","import {\n  Component,\n  ComponentInterface,\n  Element,\n  Event,\n  EventEmitter,\n  h,\n  Host,\n  Method,\n  Prop,\n  State,\n  Watch,\n} from '@stencil/core';\n\nimport { debounceEvent, getComponentIndex } from '../../utils';\n\n/**\n * 日期选择器组件\n * @Component 装饰器定义组件元数据\n * @shadow 启用Shadow DOM封装\n * @styleUrl 组件样式表路径\n * @tag 组件自定义标签名称\n */\n@Component({\n  shadow: true,\n  styleUrl: 'date-picker.scss',\n  tag: 'zane-date-picker',\n})\nexport class DatePicker implements ComponentInterface {\n  /**\n   * ARIA无障碍属性配置对象\n   * 用于存储所有aria-*属性\n   * @Prop 装饰器表示这是组件的公开属性\n   * @mutable 表示属性可变\n   * @reflect 表示属性值会反映到DOM属性上\n   */\n  @Prop({ mutable: true, reflect: true }) configAria: any = {};\n\n  /**\n   * 事件防抖时间(毫秒)\n   * 用于控制change事件的触发频率\n   * @Prop 默认值为300ms\n   */\n  @Prop() debounce = 300;\n\n  /**\n   * 是否禁用组件\n   * @Prop 装饰器，reflect表示会反映到DOM属性上\n   * 默认值为false\n   */\n  @Prop({ reflect: true }) disabled: boolean = false;\n\n  /**\n   * 宿主元素引用\n   * @Element 装饰器获取宿主元素\n   */\n  @Element() elm!: HTMLElement;\n\n  /**\n   * 组件唯一ID\n   */\n  gid: string = getComponentIndex();\n\n  /**\n   * 是否获得焦点状态\n   * @State 装饰器表示这是组件内部状态\n   */\n  @State() hasFocus = false;\n\n  /**\n   * 辅助文本\n   * 显示在输入框下方的帮助信息\n   * @Prop\n   */\n  @Prop() helperText: string;\n\n  /**\n   * 是否为内联模式\n   * @Prop 装饰器，reflect表示会反映到DOM属性上\n   */\n  @Prop({ reflect: true }) inline: boolean = false;\n\n  /**\n   * 是否为无效状态\n   * @Prop\n   */\n  @Prop() invalid: boolean = false;\n\n  /**\n   * 无效状态提示文本\n   * @Prop\n   */\n  @Prop() invalidText: string;\n\n  /**\n   * 标签文本\n   * @Prop\n   */\n  @Prop() label: string;\n\n  /**\n   * 输入框name属性\n   * 默认值为\"zane-input-{唯一ID}\"\n   * @Prop\n   */\n  @Prop() name: string = `zane-input-${this.gid}`;\n\n  /**\n   * 占位符文本\n   * @Prop\n   */\n  @Prop() placeholder: string;\n\n  /**\n   * 是否为只读状态\n   * @Prop 装饰器，reflect表示会反映到DOM属性上\n   */\n  @Prop({ reflect: true }) readonly: boolean = false;\n\n  /**\n   * 是否为必填项\n   * @Prop 装饰器，reflect表示会反映到DOM属性上\n   */\n  @Prop({ reflect: true }) required: boolean = false;\n\n  /**\n   * 组件尺寸\n   * - 'lg': 大尺寸\n   * - 'md': 中等尺寸(默认)\n   * - 'sm': 小尺寸\n   * @Prop 装饰器，reflect表示会反映到DOM属性上\n   */\n  @Prop({ reflect: true }) size: 'lg' | 'md' | 'sm' = 'md';\n\n  /**\n   * 当前值\n   * 可以是null、number或string类型\n   * @Prop 装饰器，mutable表示属性可变\n   */\n  @Prop({ mutable: true }) value?: null | number | string = '';\n\n  /**\n   * 是否为警告状态\n   * @Prop\n   */\n  @Prop() warn: boolean = false;\n\n  /**\n   * 警告状态提示文本\n   * @Prop\n   */\n  @Prop() warnText: string;\n\n  /**\n   * 失去焦点事件\n   * @Event 装饰器定义自定义事件\n   * 事件名称为'zane-date-picker--blur'\n   */\n  @Event({ eventName: 'zane-date-picker--blur' }) zaneBlur: EventEmitter;\n\n  /**\n   * 值变化事件(带防抖)\n   * @Event 装饰器定义自定义事件\n   * 事件名称为'zane-date-picker--change'\n   */\n  @Event({ eventName: 'zane-date-picker--change' }) zaneChange: EventEmitter;\n\n  /**\n   * 获得焦点事件\n   * @Event 装饰器定义自定义事件\n   * 事件名称为'zane-date-picker--focus'\n   */\n  @Event({ eventName: 'zane-date-picker--focus' }) zaneFocus: EventEmitter;\n\n  /**\n   * 输入事件(实时触发)\n   * @Event 装饰器定义自定义事件\n   * 事件名称为'zane-date-picker--input'\n   */\n  @Event({ eventName: 'zane-date-picker--input' }) zaneInput: EventEmitter;\n\n  /**\n   * 原生input元素引用\n   */\n  private nativeElement?: HTMLInputElement;\n\n  /**\n   * tabindex值\n   * 从宿主元素获取并传递给内部input元素\n   */\n  private tabindex?: number | string;\n\n  /**\n   * 组件即将加载生命周期钩子\n   * 处理ARIA属性和tabindex\n   */\n  componentWillLoad() {\n    // 处理tabindex\n    if (this.elm.hasAttribute('tabindex')) {\n      const tabindex = this.elm.getAttribute('tabindex');\n      this.tabindex = tabindex === null ? undefined : tabindex;\n      this.elm.removeAttribute('tabindex');\n    }\n    // 收集所有aria-*属性\n    this.elm.getAttributeNames().forEach((name: string) => {\n      if (name.includes('aria-')) {\n        this.configAria[name] = this.elm.getAttribute(name);\n        this.elm.removeAttribute(name);\n      }\n    });\n  }\n\n  /**\n   * 组件连接到DOM时的生命周期回调\n   * 初始化防抖设置\n   */\n  connectedCallback() {\n    this.debounceChanged();\n  }\n\n  /**\n   * 获取组件ID的公共方法\n   * @Method 装饰器定义公共方法\n   * @returns 组件唯一ID\n   */\n  @Method()\n  async getComponentId() {\n    return this.gid;\n  }\n\n  /**\n   * 渲染组件\n   * @returns 组件虚拟DOM\n   */\n  render() {\n    return (\n      <Host has-focus={this.hasFocus} has-value={this.hasValue()}>\n        <div class={{ 'form-control': true, inline: this.inline }}>\n          {this.label && (\n            <label class=\"label\">\n              {this.required && <span class=\"required\">*</span>}\n              {this.label}\n            </label>\n          )}\n\n          <div class=\"field\">\n            <div\n              class={{\n                disabled: this.disabled,\n                'has-focus': this.hasFocus,\n                'input-container': true,\n              }}\n            >\n              <input\n                class=\"input input-native\"\n                disabled={this.disabled}\n                onBlur={this.blurHandler}\n                onFocus={this.focusHandler}\n                onInput={this.inputHandler}\n                onKeyDown={this.keyDownHandler}\n                readonly={this.readonly}\n                ref={(input) => (this.nativeElement = input)}\n                required={this.required}\n                tabindex={this.tabindex}\n                type=\"date\"\n              />\n\n              <zane-button\n                class=\"input-action\"\n                color={'secondary'}\n                disabled={this.disabled}\n                icon={'calendar'}\n                onZane-button--click={() => {\n                  setTimeout(() => {\n                    this.nativeElement.showPicker();\n                  });\n                }}\n                size={this.size}\n                variant=\"ghost.simple\"\n              ></zane-button>\n            </div>\n            {this.renderHelper()}\n          </div>\n        </div>\n      </Host>\n    );\n  }\n\n  /**\n   * 渲染辅助信息\n   * 根据状态显示不同的辅助文本\n   * @returns 辅助信息虚拟DOM\n   */\n  renderHelper() {\n    if (this.invalid)\n      return <div class=\"helper invalid\">{this.invalidText}</div>;\n    else if (this.warn) return <div class=\"helper warn\">{this.warnText}</div>;\n    else if (this.helperText || this.helperText === '')\n      return <div class=\"helper text\">{this.helperText}</div>;\n  }\n\n  /**\n   * 设置失去焦点的公共方法\n   * @Method 装饰器定义公共方法\n   */\n  @Method()\n  async setBlur() {\n    if (this.nativeElement) {\n      this.nativeElement.blur();\n      this.hasFocus = false;\n    }\n  }\n\n  /**\n   * 设置获得焦点的公共方法\n   * @Method 装饰器定义公共方法\n   */\n  @Method()\n  async setFocus() {\n    if (this.nativeElement) {\n      this.nativeElement.focus();\n      this.hasFocus = true;\n    }\n  }\n\n  /**\n   * 监听debounce属性变化\n   * 更新防抖设置\n   * @Watch 装饰器监听属性变化\n   */\n  @Watch('debounce')\n  protected debounceChanged() {\n    this.zaneChange = debounceEvent(this.zaneChange, this.debounce);\n  }\n\n  /**\n   * 失去焦点事件处理\n   * @param ev 焦点事件对象\n   */\n  private blurHandler = (ev: FocusEvent) => {\n    this.hasFocus = false;\n    this.zaneBlur.emit(ev);\n  };\n\n  /**\n   * 清空输入值\n   * @param evt 事件对象\n   */\n  private clearInput = (evt: Event) => {\n    this.nativeElement.value = '';\n    this.inputHandler(evt);\n  };\n\n  /**\n   * 获得焦点事件处理\n   * @param ev 焦点事件对象\n   */\n  private focusHandler = (ev: FocusEvent) => {\n    this.hasFocus = true;\n    this.zaneFocus.emit(ev);\n  };\n\n  /**\n   * 获取当前值的字符串表示\n   * @returns 值的字符串形式\n   */\n  private getValue(): string {\n    return (this.value || '').toString();\n  }\n\n  /**\n   * 检查是否有值\n   * @returns 是否有值的布尔结果\n   */\n  private hasValue(): boolean {\n    return this.getValue().length > 0;\n  }\n\n  /**\n   * 输入事件处理\n   * @param ev 输入事件对象\n   */\n  private inputHandler = (ev: Event) => {\n    const input = ev.target as HTMLInputElement | null;\n    const oldValue = this.value;\n    if (input) {\n      this.value = input.value;\n    }\n    this.zaneInput.emit(ev as KeyboardEvent);\n    if (oldValue !== this.value) {\n      this.zaneChange.emit(ev as KeyboardEvent);\n    }\n  };\n\n  /**\n   * 键盘按下事件处理\n   * 特别处理ESC键清空输入\n   * @param ev 键盘事件对象\n   */\n  private keyDownHandler = (ev: KeyboardEvent) => {\n    if (ev.key === 'Escape') {\n      this.clearInput(ev);\n    }\n  };\n}\n"],"mappings":"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","ignoreList":[]}